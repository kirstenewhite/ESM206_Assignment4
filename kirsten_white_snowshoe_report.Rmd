---
title: "ESM 206 Assignment 4"
author: "Kirsten White"
date: "11/4/2021"
output: html_document
---

# Introduction 

----A 4 - 5 sentence "mini-introduction" to what this study is exploring, including basic background information about the subject, site and study (with citations as needed), and a brief overview of what is included in the exploratory report. You should probably do this last so you know whatâ€™s contained in the report.----

### Setup

```{r setup, include= TRUE, message = FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

# --- Attach Packages ---
library(tidyverse)
library(here)
library(janitor)
library(lubridate) 
library(kableExtra)
```

### Read in the Data
```{r}
bonanza_hares <- read_csv(here("data", "bonanza_hares.csv"))
```
# Data & Analysis 
---- A 3 - 4 sentence section in which you briefly describe the data, including citation & credit as needed, and provide an overview of the main analysis, statistical methods and tools used.---

-----Juvenile snowshoe hare size and count data is explored, analyzed, and visualized. This data was collected from the Bonanza Creek LTER, part of the US Long Term Ecological Research Network, between 1998 and 2012. 

**Data Citation**: Kielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER. 2017. Snowshoe hare physical data in Bonanza Creek Experimental Forest: 1999-Present ver 22. Environmental Data Initiative. https://doi.org/10.6073/pasta/03dce4856d79b91557d8e6ce2cbcdc14-----


# Juvenile Hare Trapping Counts 
In this section, the total number of juvenile hare trappings during each year of the study are counted and visualized. 

### Data Wrangling 
Juvenile hare trappings are counted by year. 

```{r}
juvenile_trappings <- bonanza_hares %>%
  mutate(date = mdy(date)) %>%
  mutate(year = year(date)) %>%
  filter(age == "j") %>%
  group_by(year, age) %>%
  count(age)
  
```

### Data Visualization 
```{r}
ggplot(data = juvenile_trappings, aes(x = year, y = n)) +
  geom_bar(stat = "identity", fill = "skyblue", color = "grey", width = 0.5) + 
  labs(x = "Year", 
       y = "Hare Count", 
       title = "Total Juvenile Hares Trapped by Year (1998 - 2012)",
       caption = "Data Source: Kielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER. 2017") + 
  theme_grey() + 
  theme(plot.title = element_text(face = "bold", hjust = 0.5, size = 15)) + 
  theme(axis.title = element_text(face = "bold")) +
  theme(plot.caption = element_text(hjust = 1, size = 8))
       
```
**Figure 1**: Total number of juvenile hares trapped per year from 1998 through 2012

### Summary Table & Discussion
---- CHANGE (J) TO JUVENILE ----

```{r}
juvenile_trappings_summary <- juvenile_trappings %>%
  group_by(age) %>%
  summarize(sample_size = n(), 
            min(juvenile_trappings$n, na.rm = TRUE), 
            max(juvenile_trappings$n, na.rm = TRUE), 
            mean(juvenile_trappings$n, na.rm = TRUE), 
            median(juvenile_trappings$n, na.rm = TRUE), 
            sd(juvenile_trappings$n, na.rm = TRUE)) %>%
  kbl(caption = "Table 1: Summary statistics for juvenile hare counts from 1998 - 2012", col.names = c("Age", "Sample Size", "Min", "Max", "Mean", "Median", "Standard Deviation"), digits = 1) %>%
  kable_minimal()

juvenile_trappings_summary
```
As seen in Table 1, ------ Then, in 3 - 4 sentences below your figure, describe major takeaways from your graph about total snowshoe hare trappings at the site. You might consider:------

# Juvenile Hare Weights
In this section, juvenile hare weights are compared by sex and site then visualized. 

### Data Wrangling 
```{r}
juvenile_weights <- bonanza_hares %>%
  filter(age == "j") %>%
  select(sex, weight, grid) %>%
  mutate(grid_full = case_when(
        grid == "bonbs" ~ "Bonbs", 
        grid == "bonmat" ~ "Bonanza Mature", 
        grid == "bonrip" ~ "Bonanza Riparian")) %>%
  mutate(sex = case_when(
        sex == "m" ~ "M", 
        sex == "f" ~ "F"))
```

### Data Visualization 

```{r}
ggplot(data = juvenile_weights, aes(x = sex, y = weight, color = grid_full))+
  geom_jitter(width = 0.05, size = 0.9, show.legend = "None") +
  facet_wrap(~ grid_full) +
   labs(x = "Sex", 
       y = "Weight (g)", 
       color = "Site",
       title = "Juvenile Hare Weight by Sex and Site (WHITE)", 
       caption = "Data Source: Kielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER. 2017") + 
  theme(plot.title = element_text(face = "bold"))+
  theme(plot.caption = element_text(hjust = 1, size = 8))+
  theme(axis.title = element_text(face = "bold")) 
```
**Figure 2**: Female and male juvenile hare weights in grams visualized by sex and site

---- EDIT Y AXIS LENGTH ----

```{r}
juvenile_weights_summary <- juvenile_weights %>%
  group_by(grid_full, sex) %>%
  summarize(sample_size = n(), 
            mean_weight = mean(weight, na.rm = TRUE), 
            median_weight = median(weight, na.rm = TRUE), 
            min_weight = min(weight, na.rm = TRUE), 
            max_weight = max(weight, na.rm = TRUE),
            sd_weight = sd(weight, na.rm = TRUE)) %>%
  kbl(caption = "Table 2: Summary statistics for male and female juvenile weights (g)", col.names = c("Site", "Sex","Sample Size", "Mean (g)", "Median (g)", "Min (g)", "Max (g)", "Standard Deviation (g)"), digits = 1) %>%
  kable_minimal()

juvenile_weights_summary
```

As represented in Figure 2 and Table 2, ------discuss what we see------


